@using DNSLab.Web.DTOs.Repositories.ReeverseProxy
@attribute [Route(AllRoutes.ActiveTunnels)]
@attribute [Authorize]
<SeoProvider Title="تونل های فعال" />

<MudCard Elevation="0">
    <MudCardHeader>
        <CardHeaderContent>
            <MudText Typo="Typo.h5">تونل های فعال</MudText>
        </CardHeaderContent>
        <CardHeaderActions>
            <BaseButton Variant="Variant.Filled" Size="Size.Small" Color="Color.Primary" EndIcon="@DNSLabIcons.Refresh" OnClick="OnInitializedAsync">بروزرسانی</BaseButton>
        </CardHeaderActions>
    </MudCardHeader>
    <MudCardContent>
        <MudDataGrid T="ReverseProxyTunnelDTO" Items="_Tunnels?.OrderByDescending(x=> x.Name)" Loading="_Loading" Dense Hover Outlined>
            <NoRecordsContent>
                <MudAlert Dense Severity="Severity.Warning" ContentAlignment="HorizontalAlignment.Center" NoIcon>
                    <MudText Typo="Typo.body2">هیچ تونل فعالی وجود ندارد!</MudText>
                </MudAlert>
            </NoRecordsContent>
            <Columns>
                <PropertyColumn Property="x=>x.Name" Title="آدرس">
                    <CellTemplate>
                        <MudLink Href='@($"http://tcp.dnslab.ir:{@context.Item.RemotePort}")' Target="_blank" Underline="Underline.None">http://tcp.dnslab.ir:@context.Item.RemotePort</MudLink>
                    </CellTemplate>
                </PropertyColumn>
                <PropertyColumn Property="x=>x.LocalIp" Title="آی پی محلی" />
                <PropertyColumn Property="x=>x.LocalPort" Title="پورت محلی" />
                <PropertyColumn Property="x=>x.RemotePort" Title="پورت اختصاصی" />
                <PropertyColumn Property="x=>x.Type" Title="نوع پروتکل">
                    <CellTemplate>
                        <MudChip T="string" Color="Color.Info" Size="Size.Small" Label="true">@context.Item.Type.ToString()</MudChip>
                    </CellTemplate>
                </PropertyColumn>
            </Columns>
        </MudDataGrid>
    </MudCardContent>
</MudCard>
