@using DNSLab.Web.DTOs.Repositories.DDNS
@attribute [Route(AllRoutes.UpdateTokens)]
@attribute [Authorize]

@if (!IsSelectableList)
{
    <SeoProvider Title="کلید ها" />
}

<MudText Typo="Typo.h1" Align="Align.Center">کلید ها</MudText>
<MudText Class="mt-5 mb-10" Align="Align.Center">از کلید میتوانید به عنوان یک روش برای بروزرسانی اطلاعات یک یا چند هاست نِیم استفاده نمایید</MudText>

<MudCard Elevation="0">
    <MudCardContent>
        <MudDataGrid T="UpdateTokenDTO" Items="_Tokens" Loading="_IsLoading" Dense Hover Outlined>
            <NoRecordsContent>
                <NoRecordFound />
            </NoRecordsContent>
            <Columns>
                @if (IsSelectableList)
                {
                    <TemplateColumn>
                        <CellTemplate>
                            <MudStack Row Justify="Justify.FlexStart" Spacing="1">
                                <BaseButton EndIcon="@DNSLabIcons.Check" Size="Size.Small" DropShadow="false" Color="Color.Primary" Variant="Variant.Filled" OnClick="()=> SelectToken(context.Item)">انتخاب</BaseButton>
                            </MudStack>
                        </CellTemplate>
                    </TemplateColumn>
                }
                <PropertyColumn Property="x=>x.Name" Title="نام" />
                <TemplateColumn Title="کلید">
                    <CellTemplate>
                        <MudChip T="string" Color="Color.Default" Size="Size.Small" Label="true" Icon="@DNSLabIcons.Key">@context.Item.Key</MudChip>
                    </CellTemplate>
                </TemplateColumn>
                @if (!IsSelectableList)
                {
                    <TemplateColumn>
                        <CellTemplate>
                            <MudGrid Justify="Justify.Center" Spacing="1">
                                <MudItem>
                                    <BaseButton OnClick="()=> CopyLink(context.Item)" DropShadow="false" Color="Color.Default" Size="Size.Small" Variant="Variant.Filled" EndIcon="@DNSLabIcons.Copy">
                                        <MudText Typo="Typo.body2">Link</MudText>
                                    </BaseButton>
                                </MudItem>
                                <MudItem>
                                    <BaseButton OnClick="()=> DownloadScript(context.Item.Id,1)" DropShadow="false" Color="Color.Default" Size="Size.Small" Variant="Variant.Filled" EndIcon="@DNSLabIcons.Document">
                                        <MudText Typo="Typo.body2">Shell (Wget)</MudText>
                                    </BaseButton>
                                </MudItem>
                                <MudItem>
                                    <BaseButton OnClick="()=> DownloadScript(context.Item.Id,2)" DropShadow="false" Color="Color.Default" Size="Size.Small" Variant="Variant.Filled" EndIcon="@DNSLabIcons.Document">
                                        <MudText Typo="Typo.body2">Shell (Curl)</MudText>
                                    </BaseButton>
                                </MudItem>
                                <MudItem>
                                    <BaseButton OnClick="()=> DownloadScript(context.Item.Id,3)" DropShadow="false" Color="Color.Default" Size="Size.Small" Variant="Variant.Filled" EndIcon="@DNSLabIcons.Document">
                                        <MudText Typo="Typo.body2">PowerShell (RestMethod)</MudText>
                                    </BaseButton>
                                </MudItem>
                            </MudGrid>
                        </CellTemplate>
                    </TemplateColumn>
                }
                <TemplateColumn>
                    <CellTemplate>
                        <MudStack Row Justify="Justify.FlexEnd" Spacing="1">
                            <BaseIconButton OnClick="()=> EditToken(context.Item)" DropShadow="false" Size="Size.Small" Variant="Variant.Filled" Icon="@DNSLabIcons.Edit" />
                            <BaseIconButton OnClick="()=> RevokeTokenKey(context.Item)" DropShadow="false" Size="Size.Small" Variant="Variant.Filled" Icon="@DNSLabIcons.ChangeKey" />
                            <BaseIconButton OnClick="()=> DeleteToken(context.Item)" DropShadow="false" Color="Color.Error" Size="Size.Small" Variant="Variant.Filled" Icon="@DNSLabIcons.Delete" />
                        </MudStack>
                    </CellTemplate>
                </TemplateColumn>
            </Columns>
        </MudDataGrid>
        @if (IsSelectableList == false)
        {
            <MudAlert Class="mt-3" Icon="@DNSLabIcons.Info" Dense ContentAlignment="HorizontalAlignment.Start">
                <MudText Typo="Typo.body2">کلید های DNSLab برای بروزرسانی آی‌پی هاست نیم ها استفاده میشوند.</MudText>
                <MudText Typo="Typo.body2">شما میتوانید از کلید بصورت مستقیم با فراخوانی لینک آن آی‌پی هاست نیم های متصل به کلید را بروزرسانی نمایید و یا از منوی تنظیمات Mikrotik از کلید برروی مودم خود استفاده نمایید.</MudText>
                <MudText Typo="Typo.body2">همچنین شما میتوانید بصورت Task Scheduler اسکریپت کلید مورد نظر را در سیستم عامل قرار دهید تا بصورت خودکار یک بار در هنگام روشن شدن سیستم اجرا شود تا آی‌پی بروزرسانی شود.</MudText>
            </MudAlert>
        }
    </MudCardContent>
</MudCard>